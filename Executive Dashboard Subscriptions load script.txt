///$tab Main
SET ThousandSep=',';
SET DecimalSep='.';
SET MoneyThousandSep=',';
SET MoneyDecimalSep='.';
SET MoneyFormat='$#,##0.00;($#,##0.00)';
SET TimeFormat='h:mm:ss TT';
SET DateFormat='M/D/YYYY';
SET TimestampFormat='M/D/YYYY h:mm:ss[.fff] TT';
SET MonthNames='Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec';
SET DayNames='Mon;Tue;Wed;Thu;Fri;Sat;Sun';

Table1:

load * inline [

ID,name,type,value

1,A,blue,10

1,A,yellow,50

3,C,red,80

3,C,yellow,60

4,D,yellow,40

];

Table2:

generic load *

resident Table1;

ResultTable: 

LOAD Distinct ID, name Resident Table1; 

 

FOR i = 0 to NoOfTables() 

  TableList: 

  LOAD TableName($(i)) as Tablename AUTOGENERATE 1 

  WHERE WildMatch(TableName($(i)), 'Table2.*'); 

NEXT i 

 

FOR i = 1 to FieldValueCount('Tablename') 

  LET vTable = FieldValue('Tablename', $(i)); 

  LEFT JOIN (ResultTable) LOAD * RESIDENT [$(vTable)]; 

  DROP TABLE [$(vTable)]; 

NEXT i 

 

Drop Tables Table1, TableList;
